{
    "source_file": "./raw_volume-zh/volume6/exercise1.tex",
    "problem_type": "proof",
    "problem": "问题42. 给定素数 $p>3$, 令 $q=p^3$. 定义数列 $a_n$ 如下\n$$\na_n=\\left\\{\\begin{array}{l}\nn, n=0,1,2, \\cdots p-1, \\\\\na_{n-1}+a_{n-p}, n>p-1 .\n\\end{array}\\right.\n$$\n求 $a_q$ 除以 $p$ 所得的余数.",
    "solution": "引理设 $n 、 k \\in \\mathbf{N}^*, n \\geqslant k p$, 则(1)\n$$\na_n=\\sum_{i=0}^k \\mathrm{C}_k^i a_{n-i(p-1)-k} .\n$$\n对 $k$ 归纳予以证明.\n当 $k=1$ 时, (1) 就是 $a_n=a_{n-1}+a_{n-p}$, 故 (1) 对 $k=1$ 成立.\n现设 (1) 对 $k$ 成立, 考虑 $k+1$ 的情形.\n此时 $n \\geqslant(k+1) p$,下标 $n-i(p- 1)-k(0 \\leqslant i \\leqslant k)$ 的最小值在 $i=k$ 时取到, 该最小值为 $n-k p \\geqslant p$, 所以, 下面求和式中的每一项都可用条件中的递推式.\n由归纳假设知, 当 $n \\geqslant(k+1) p$ 时, 有\n$$\n\\begin{aligned}\na_n & =\\sum_{i=0}^k \\mathrm{C}_k^i a_{n-i(p-1)-k} \\\\\n& =\\sum_{i=0}^k \\mathrm{C}_k^i\\left(a_{n-i(p-1)-k-1}+a_{n-i(p-1)-k-p}\\right) \\\\\n& =\\mathrm{C}_k^0 a_{n-k-1}+\\sum_{i=1}^k \\mathrm{C}_k^i a_{n-i(p-1)-k-1}+\\sum_{i=0}^{k-1} \\mathrm{C}_k^i a_{n-i(p-1)-k-p}+\\mathrm{C}_k^k a_{n-(k+1) p} \\\\\n& =\\mathrm{C}_{k+1}^0 a_{n-(k+1)}+\\sum_{i=0}^{k-1} \\mathrm{C}_k^{i+1} a_{n-(i+1)(p-1)-(k+1)}+\\sum_{i=0}^{k-1} \\mathrm{C}_k^i a_{n-(i+1)(p-1)-(k+1)}+\\mathrm{C}_{k+1}^{k+1} a_{n-(k+1) p} \\\\\n& =\\mathrm{C}_{k+1}^0 a_{n-(k+1)}+\\sum_{i=0}^{k-1}\\left(\\mathrm{C}_k^{i+1}+\\mathrm{C}_k^i\\right) a_{n-(i+1)(p-1)-(k+1)}+\\mathrm{C}_{k+1}^{k+1} a_{n-(k+1) p} \\\\\n& =\\sum_{i=0}^{k+1} \\mathrm{C}_{k+1}^i a_{n-(i+1)(p-1)-(k+1)} .\n\\end{aligned}\n$$\n最后一步,用到 $\\mathrm{C}_k^{i+1}+\\mathrm{C}_k^i=\\mathrm{C}_{k+1}^{i+1}$. 所以, (1)对 $k+1$ 成立,引理获证.\n下面利用引理来处理原题.\n当 $n \\geqslant p^2$ 时, 在引理中令 $k=p$, 就有\n$$\na_n=\\sum_{i=0}^p \\mathrm{C}_p^i a_{n-i(p-1)-p},\n$$\n熟知, 当 $1 \\leqslant i \\leqslant p-1$ 时, 有 $\\mathrm{C}_p^i \\equiv 0(\\bmod p)$, 所以, $a_n \\equiv a_{n-p}+a_{n-p^2}(\\bmod p)$, 这时结合 $a_n=a_{n-1}+a_{n-p}$, 可得 $a_{n-1} \\equiv a_{n-p^2}(\\bmod p)$, 这表明对任意 $t \\geqslant p^2-$ 1 , 有 $a_t \\equiv a_{t+p^2-1}(\\bmod p)$.\n由于 $p^3=p\\left(p^2-1\\right)+p$, 故 $a_{p^3}=a_{p+p\\left(p^2-1\\right)} \\equiv a_p(\\bmod p)$, 而 $a_p=a_0+ a_{p-1}=p-1$, 所以 $a_{p^3} \\equiv p-1(\\bmod p)$, 即 $a_{p^3}$ 除以 $p$ 所得的余数为 $p-1$.",
    "remark": "",
    "figures": []
}