{
    "source_file": "./raw_volume-zh/volume14/chapter13.tex",
    "problem_type": "calculation",
    "problem": "例4. 在 $(1,2, \\cdots, n)$ 的一个排列 $\\left(a_1, a_2, \\cdots, a_n\\right)$ 中, 如果 $a_i \\neq i(i= 1,2, \\cdots, n$ ), 则称这种排列为一个错位排列 (也称更列). 求错位排列的个数 $D_n$.",
    "solution": "解:知 $D_1=0, D_2=1$.\n对于 $n \\geqslant 3$ 及 $(1,2, \\cdots, n)$ 的任意一个错位排列 $\\left(a_1, a_2, \\cdots, a_n\\right)$ 中, $a_1$ 可取除 1 以外的任一其他 $n-1$ 个数,设 $a_1=k(k \\neq 1)$, 于是\n(1) 如果 $a_k=1$, 这种错位排列数等于 $n-2$ 个元素的错位排列数 $D_{n-2}$;\n(2) 如果 $a_k \\neq 1$, 则这种错位排列就是元素 $1,2, \\cdots, k-1, k+1, \\cdots, n$ 在第 2 到第 $n$ 这 $n-1$ 个位置上的一个排列, 其中 1 不在第 $k$ 个位置, 其他元素都不在它自身所标记的位置上, 这种排列相当于 $2,3, \\cdots, n$ 这 $n-1$ 个元素的一个错位排列, 所以共有 $D_{n-1}$ 个.\n考虑到 $k=2,3, \\cdots, n$ 共 $n-1$ 种这样的情况, 我们得到\n$$\nD_n=(n-1)\\left(D_{n-1}+D_{n-2}\\right)(n \\geqslant 3) . \\label{eq1}\n$$\n令 $E_n=\\frac{D_n}{n !}$, 则 式\\ref{eq1} 可变形为 $E_n=\\left(1-\\frac{1}{n}\\right) E_{n-1}+\\frac{1}{n} E_{n-2}$, 所以\n$$\nE_n-E_{n-1}=-\\frac{1}{n} \\cdot\\left(E_{n-1}-E_{n-2}\\right) . \\label{eq2}\n$$\n反复利用 式\\ref{eq2}, 并注意到 $E_1=0, E_2=\\frac{1}{2}$, 对 $n \\geqslant 2$, 有\n$$\n\\begin{aligned}\nE_n-E_{n-1} & =\\left(-\\frac{1}{n}\\right) \\cdot\\left(-\\frac{1}{n-1}\\right) \\cdot\\left(E_{n-2}-E_{n-3}\\right)=\\cdots \\\\\n& =\\left(-\\frac{1}{n}\\right) \\cdot\\left(-\\frac{1}{n-1}\\right) \\cdots\\left(-\\frac{1}{3}\\right) \\cdot\\left(E_2-E_1\\right)=\\frac{(-1)^n}{n !} .\n\\end{aligned}\n$$\n由此可得\n$$\nE_n=\\frac{(-1)^n}{n !}+\\frac{(-1)^{n-1}}{(n-1) !}+\\cdots+\\frac{(-1)^2}{2 !},\n$$\n所以\n$$\nD_n=n ! \\cdot\\left(1-\\frac{1}{1 !}+\\frac{1}{2 !}-\\cdots+(-1)^n \\frac{1}{n !}\\right) .\n$$",
    "remark": "注:这是著名的\"错位排列\"计数问题的一种递推解法.\n在建立递推关系时, 对应原理是必不可少的, 但有时候需要变通地找出对应关系, 例如在上述解法讨论 $a_1=k, a_k \\neq 1$ 的情况时, 把元素 1 暂时视作 $k$, 即对应到 $2,3, \\cdots, n$ 这 $n-1$ 个元素的一个错位排列.",
    "figures": []
}